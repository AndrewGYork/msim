

# The Microscope #
https://sites.google.com/site/msimdocumentation/home/SIM%20set-up.JPG


# Things to turn on #
1. Both red switches

2. DMD

3. Computer

4. Shutters – 488nm and/or 561nm

5. Nitrogen gas – for the table

6. Turn the key for the laser(s) – 488nm and/or 561nm

7. Also, verify that the filter cube on the microscope is in position 1 and the plunger is out


# Taking a calibration #
## Finding the sample ##
1. Load a calibration slide (also referred to as the lake) on the microscope

  * **NOTE:** The orange slide can be used for both 561nm and 488nm lasers
  * **NOTE:** Don't forget to add oil to the objective (from the brown bottle for the 60X oil objective, from the green bottle for the 60X silicone objective)

https://sites.google.com/site/msimdocumentation/home/Oil%20and%20calibration%20slides.JPG

2. Open _CamWare64_ (camera software) and _AlpBasic_ (DMD software) from the desktop

3. In _AlpBasic_,

  * Close the untitled window and open “default DMD script” (found in Documents\SIM)
  * Go to “Device,” click on “Attach,” and then select “ok” to attach the DMD
  * Press the “Pause/single step” button until the green arrow is next to the “sleep” line below the “illumination\_pattern-1”

https://sites.google.com/site/msimdocumentation/home/AlpBasic.JPG

4. In _CamWare64_,

  * Click on the “Live Preview” button (magnifying glass) to see the current field of view
  * Ensure the “Continuous auto-range” is on

https://sites.google.com/site/msimdocumentation/home/CamWare.JPG

5. Press the “Enable” button on the shutter for the correct laser depending on the lake

https://sites.google.com/site/msimdocumentation/home/Shutter.JPG

6. Use the focusing knob on the microscope to focus on the sample

  * You should see a pattern of dots spread out across the screen
  * At this point, verify that the z-position is set to 0 on the stage controller

https://sites.google.com/site/msimdocumentation/home/z%20piezo.JPG

7. Once the sample is in focus, exit out of _CamWare64_ and _AlpBasic_

  * For _CamWare64_, ensure “Live Preview” is no longer on before exiting
  * For _AlpBasic_, press the “Stop” button and unattach device by going to “Device” and clicking on “Attach” before exiting


## Taking the lake images ##
1. Open _sim\_scope.py_ (master code for taking data) [(1)](http://code.google.com/p/msim/wiki/Data_Acquisition?ts=1335554453&updated=Data_Acquisition#%281%29_Guide_to_sim_scope.py_%27s_parameters) by right clicking the file and selecting “Edit with IDLE”

  * Location: RAID(D)\SIM\_data\python

2. In _sim\_scope.py_, set the following parameters (can be found at the bottom of the code) as shown in the image below to take a 488nm lake image with filter 1 and then a 561nm lake image with filter 3 [(2)](http://code.google.com/p/msim/wiki/Data_Acquisition#%282%29_Colors_and_taking_a_lake)

https://sites.google.com/site/msimdocumentation/home/lake.JPG

  * **NOTE:** _z\_positions=range(-100, 100, 2)_ should be commented out (as indicated by ## and red font) - you can do so by highlighting the line and pressing  “Alt + 3”
  * **NOTE:** If _z\_positions=[0, 0, 0, 0]_ is commented out, highlight the line and press “Alt + 4” to comment it in

3. Save _sim\_scope.py_ and then go to “Run” and then select “Run module” (or just click F5) to run the program

4. This will bring up a window asking you to select the folder in which to save the files [(3)](http://code.google.com/p/msim/wiki/Data_Acquisition#%283%29_Instructions_for_setting_up_folders) as well as the basename (ex: "lake") to use for those files

  * **NOTE:** if you are taking images with 2 different filters and/or lasers, then it will ask you for a basename twice (ex: "lake1" and "lake2")
  * **NOTE:** _sim\_scope.py_ saves files in the format of basename\_laser\_filter\_z####.raw (laser: c488 or c561; filter: f1, f2, or f3; z#### refers to the image number)
  * **NOTE:** If the laser shutters are unresponsive, you may have to restart the computer. I don't know why, but sometimes our serial port communication is flaky.


## Checking for best lake image and saturation ##
1. Open _ImageJ_ from the desktop

2. Open the max projection generated by _sim\_scope.py_

  * Go to “File,” then “Import,” and select “Raw”
  * Find the folder within which you saved the lake
  * Select the file with the following format “stack\_of\_max\_projections\_basename\_cXXX\_fX\_zXXXX.raw”
  * When the “Import” window appears, set the following parameters

https://sites.google.com/site/msimdocumentation/home/Import%20raw.JPG

  * Click “OK”

3. Scroll through the 4 lakes and choose the one that looks the best

  * If they have a striping artifact, don’t use them
  * Delete any images that do not look good, and move the ones other than the best to a “backup lake” folder so as to not confuse yourself when choosing the lake for processing
  * **NOTE:** we want to have multiple lake choices in case the one we use initially gives us bad results

4. Press “Cntrl + M” and check that the value under “Max” in the window that appears is less than 65,000

  * If it is not, then retake the lake image with the laser at a lower power level

https://sites.google.com/site/msimdocumentation/home/max%20value.JPG


# Taking data #
## Finding the sample ##
1. Load your sample on the microscope

  * A drop of oil (brown bottle) or silicone oil (green bottle) should be placed on the appropriate 60X objective before loading your sample

2. Open _CamWare64_

3. In _CamWare64_,

  * Click on the “Live Preview” button (magnifying glass) to see the current field of view
  * Ensure the “Continuous auto-range” is on
  * **NOTE:** Sometimes it helps to view the entire FOV covered by the camera (normally it it cropped to a 480 by 480 pixel screen) [(4)](http://code.google.com/p/msim/wiki/Data_Acquisition#%284%29_Maximizing_the_FOV_in_CamWare64)

4. Turn on the microscope light to view the sample in brightfield

  * May have to press the “Load” button on pad located next to microscope if there is no light

https://sites.google.com/site/msimdocumentation/home/load%20button.JPG

5. Use the focusing knob on the microscope to focus on the sample

  * At this point, verify that the z-position is set to 0 on the stage controller


## Scouting for fluorescence ##
1. After focusing in brightfield, turn off the microscope light and open _AlpBasic_

2. In _AlpBasic_,

  * Close the untitled window and open “default DMD script” (found in Documents\SIM)
  * Go to “Device,” click on “Attach,” and then select “ok” to attach the DMD
  * Press the “Pause/single step” button until the green arrow is next to the “sleep” line below the “white” pattern

3.	Verify that the ND is in front of the laser! (or you might fry your sample)

  * **NOTE:** this is the only time the ND should be in front of the laser – if you are using the “illumination\_pattern-1” in _AlpBasic_ or Andy’s program, the ND should not be there

4. Press the “Enable” button on the shutter for either the 488nm or 561nm laser

5. Check to see if there is fluorescence on _CamWare64_ (live preview mode)

  * **NOTE:** you may have to move the focusing knob a bit
  * **NOTE:** If you don't see any signal, then turning up the exposure time might help

6. Once the sample is in focus, exit out of _CamWare64_ and _AlpBasic_


## Taking a brightfield image ##
1. Reshutter the lasers and turn the microscope light back on

2. In _CamWare64_,

  * Press the “Camera control” control button and then change  to “auto sequence” trigger mode (yellow arrow)
  * Press “Record” and then press “Stop” to take an image
  * Go to “File” and then “Save Raw File” and select “tif”

https://sites.google.com/site/msimdocumentation/home/brightfield.JPG

3. Exit out of _CamWare64_ and _AlpBasic_


## Taking actual data ##
1. Open _sim\_scope.py_ by right clicking the file and selecting “Edit with IDLE”

2. In _sim\_scope.py_, set the following parameters (can be found at the bottom of the code) as shown in the image below to take a 488nm z-stack with filter 1 and then a 561nm z-stack with filter 3

  * **NOTE:** _z\_positions==[0, 0, 0, 0]_ should be commented out (as indicated by ## and red font) - you can do so by highlighting the line and pressing  “Alt + 3”
  * **NOTE:** If _z\_positions=range(-100, 100, 2)_ is commented out, highlight the line and press “Alt + 4” to comment it in
  * **NOTE:** _z\_positions=range(-100, 100, 1)_ means “start at -10um,” “stop at 10um,” and take 200nm steps” as the units are 100nm
    * You will change these numbers depending on your sample
    * Typically a step size of 100-200 nm is used
  * **NOTE:** If you are unsure of the exact range you want to image over, taking a preliminary coarse stack is a good idea [(5)](http://code.google.com/p/msim/wiki/Data_Acquisition#%285%29_Taking_a_coarse_stack)
  * **NOTE:** You also have the ability to take a time series [(6)](http://code.google.com/p/msim/wiki/Data_Acquisition#%286%29_Taking_a_time_series)

https://sites.google.com/site/msimdocumentation/home/sample.JPG

3. Save _sim\_scope.py_ and then press F5 to run the program

4. This will bring up a window asking you to select the folder in which to save the files as well as the basename to use for those files

  * **NOTE:** If taking dual color images, the window asking where to save the data and what basename to use will pop up twice (the first time corresponds to the first laser/filter being used, and the second to the second laser/filter being used - be sure to give each a different name)


## Checking the data ##
1. Open _ImageJ_ from the desktop

2. Open the max projection generated by _sim\_scope.py_

  * Go to “File,” then “Import,” and select “Raw”
  * Find the folder within which you saved the data
  * Select “stack\_of\_max\_projections\_basename\_cXXX\_fX\_zXXXX.raw”
  * When the “Import” window appears, set the following parameters
    1. Image Type: 16-bit unsigned
    1. Width: 480 pixels
    1. Height: 480 pixels
    1. Offset to First Image: 0 bytes
    1. Number of Images: 2147483647 (maximum value)
    1. Gap Between Images: 0 bytes
    1. Also, check the “Little-Endian Byte Order” box
  * Click “OK”

3. Scroll through the images to verify the range covers the entire sample and for an initial look before processing


# Footnotes #

### (1) _sim\_scope.py_'s parameters ###
1. _time\_delays_: for taking a time series

2. _z\_positions_: indicates the z-position(s) at which an image is being taken

  * If you want to take a range, use _z\_positions_=range(starting value, ending value, step size) with units of 100nm

3. _repetition\_period\_microsecond_: 4500 (default)

  * If your sample has less signal, you can increase this value to one of the values listed under “available exposures” at the top of the code
  * **NOTE:** _illumination\_microseconds=100_ should always be commented out

4. _pattern_: sim or widefield

5. _colors_: refers to the illumination color (i.e. which laser are you trying to use) and the emission filter being used

  * Ex: ‘488’ , ‘f1’ means 488nm laser and filter 1


### (2) Colors and taking a lake ###
Depending on what you are imaging, you might need to take a different set of lakes.

For example, if your sample is single-color, then you only need to take a lake of that color.  You can do this by commenting out the entire section for the other color (from _filenames, t\_points, z\_points = z\_t\_series(_ to the _)_ at the end).

Also, you need to determine which filter to use.  'fl' and 'f2' are more restrictive filters while 'f3' is our most permissive filter.  Typically, we used 'f1' for GFP (and similar fluorophores) in order to block out potential bleadthrough from the other color (as sometimes happens when 'f3' is used).  Either 'f2' or 'f3' is used with the 561 nm laser, typically with equal success.  However, sometimes 'f2' can result in a dimmer signal so we usually use 'f3' for 561.

**Specifications of the filters**
  * f1: 525/50 BP
  * f2: 645/75 BP
  * f3: 488 LP/561 NF


### (3) Instructions for setting up folders ###
When taking data, we create a new folder located in the SIM\_data folder within the RAID(D).  The new folder follows the following nomenclature: year\_month\_date\_identifier.  The identifier is typically something like the person's name or the sample being imaged.

The lakes are saved within the newly created folder.  Then, each data set is saved within its own FOV# folder.


### (4) Maximizing the FOV in _CamWare64_ ###
When trying to find your sample, it can be helpful to maximize the FOV in _CamWare64_ from the normal 480 by 480 pixel FOV used when taking images.  To do so:

1. Press the “Camera control” control button

https://sites.google.com/site/msimdocumentation/home/screen%20size%20%28annotated%29.JPG

2. Select the "Sensor (Size)" tab (yellow arrow)

3. Click the "Set to max" button (orange arrow)

After you have found the sample using the larger FOV, you will need to return to the 480 by 480 pixel FOV

  * **NOTE:**  The default FOV size is 841 to 1320 (vertical), 961 to 1440 (horizontal) – i.e. 480 by 480


### (5) Taking a coarse stack ###
Sometimes it is helpful to take a coarse stack over a wide range (10s of nm) with big steps (500-1000 nm) in order to determine where the sample is in z.

  * **NOTE:** It is only necessary to take a coarse stack using one color, so the code for taking a second color should be commented out (i.e. red with a # on the far lef)

https://sites.google.com/site/msimdocumentation/home/coarse%20stack.JPG

After taking the coarse stack using _sim\_scope.py_, open the maximum projections file in ImageJ.  Scroll through the stack to determine at which slice the sample's signal begins and ends.  Then, open the index file (basename\_index.txt).  This file lists the z-position and time at which each slice was taken.  Use this to determine the z-position corresponding to the sample's signal, and adjust the _z\_positions=range(start, stop, step size)_ parameter according.

  * **NOTE:** Because numbering of the slices by _sim\_scope.py_ begins at z0000, slice 1 in ImageJ corresponds to image z0000 and so on.

https://sites.google.com/site/msimdocumentation/home/index.JPG

Once you determine this, then you can then adjust the _z\_positions_ parameters to a smaller range covering the entire sample with a smaller step size (100-200 nm)


### (6) Taking a time series ###

If you do not want to take a time series, then use

```
time_delays=[None]
```

To create a time series, modify the _time\_delays_ as in the following example:

```
time_delays=[30]*20
```

  * In this example, the number within the brackets indicates the time delay (in seconds) after each round of acquisition - in this case, 30 seconds
    * **NOTE:** This refers to the time between the _END_ of one round and the _BEGINNING_ of the next. To determine the time between the beginning of each round, you need to calculate the time required for acquisition and then add it to the time delay. This information can also be found within the index file (basename\_index.txt).
  * In this example, the number to the right of the star indicates the number of times the time delay will be taken - in this case, 20 times (which will result in 21 time points)

Data taken as a time series is saved using the following format: basename\_laser\_filter\_t####